<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<title>STORYHUB</title>

<style>
body{margin:0;font-family:Arial;background:#f2f2f2}
.story{background:#fff;padding:16px;border-radius:8px;margin-bottom:15px}
.cover{width:300px;height:300px;object-fit:cover;border-radius:8px}
.tag{background:#0984e3;color:#fff;padding:4px 8px;border-radius:4px;font-size:12px}
</style>
</head>

<body>

<h2>Danh sách truyện</h2>
<div id="storyList"></div>

<script>
let STORIES = {};

async function loadStories() {
  const res = await fetch("./data/stories.json");
  STORIES = await res.json();
  renderStories();
}

function renderStories() {
  const list = document.getElementById("storyList");
  list.innerHTML = "";

  Object.values(STORIES).forEach(story => {
    list.innerHTML += `
      <div class="story">
        <img src="${story.cover}" class="cover">
        <h3>${story.title}</h3>
        <p>${story.description}</p>
        <span class="tag">${story.category}</span>

        <div>
          <select data-story="${story.id}" onchange="goReader(this)">
            <option value="">-- Chọn chương --</option>
            ${Object.keys(story.chapters)
              .map(c => `<option value="${c}">${c.replace("chap","Chapter ")}</option>`)
              .join("")}
          </select>
        </div>
      </div>
    `;
  });
}

function goReader(select) {
  if (!select.value) return;
  const story = select.dataset.story;
  const chap = select.value;
  location.href = `reader.html?story=${story}&chap=${chap}`;
}

loadStories();
</script>

</body>
</html>
